---
import Layout from '../../components/Layout.astro';
import { Header } from '../../components/react/Header';
import { Footer } from '../../components/react/Footer';
import { DailyList } from '../../components/react/DailyList';
import { client } from '@/lib/sanity';
import groq from 'groq';
import type { SanityDaily } from '@/types/sanity';

const dailyItems = await client.fetch<SanityDaily[]>(groq`
  *[_type == "daily"] | order(date desc) {
    _id,
    title,
    date,
    generatedAt,
    "slug": slug.current,
    items[]{
      _type,
      title,
      description,
      link,
      source,
      publishedAt,
      media[]{
        _type,
        kind,
        url,
        caption
      }
    }
  }
`);
---

<Layout title="Daily Vancouver Roundup â€” Orange Whip">
  <Header client:load />

  <main class="container-max section-padding">
    <div class="text-center mb-12">
      <h1 class="text-4xl sm:text-5xl font-display font-bold text-gradient mb-4">Vancouver Show Roundups</h1>
      <p class="text-xl text-secondary-300 max-w-2xl mx-auto">Daily listings of Vancouver music events</p>
    </div>
    
    {dailyItems?.length > 0 ? (
      <DailyList client:load dailyItems={dailyItems} />
    ) : (
      <div class="text-center py-16">
        <p class="text-2xl text-secondary-300">No daily roundups available yet.</p>
        <p class="text-lg text-secondary-400 mt-2">Check back soon for Vancouver show listings!</p>
      </div>
    )}
  </main>
  
  <Footer client:load />
</Layout>
