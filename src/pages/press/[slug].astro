---
import Layout from '../../components/Layout.astro';
import { Header } from '../../components/react/Header';
import { Footer } from '../../components/react/Footer';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const press = await getCollection('press');
  return press.map(item => ({
    params: { slug: item.slug },
    props: { item },
  }));
}

const { item } = Astro.props;
const { Content } = await item.render();
const pressDate = new Date(item.data.date);
const formattedDate = pressDate.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});
---

<Layout title={`${item.data.title} â€” Orange Whip`} description={item.body.slice(0, 160)}>
  <Header client:load />

  <main class="container-max section-padding">
    <div class="max-w-4xl mx-auto">
      <!-- Back to Press Link -->
      <div class="mb-8">
        <a href="/press" class="text-primary-400 hover:text-primary-300 transition-colors duration-200">
          &larr; Back to all press
        </a>
      </div>

      <!-- Press Header -->
      <div class="text-center mb-12">
        <h1 class="text-4xl sm:text-5xl font-display font-bold text-gradient mb-4">{item.data.title}</h1>
        <p class="text-lg text-secondary-400 mb-4">{formattedDate}</p>
        {item.data.tags && item.data.tags.length > 0 && (
          <div class="flex justify-center flex-wrap gap-2">
            {item.data.tags.map((tag: string) => (
              <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-secondary-800 text-primary-400">
                {tag}
              </span>
            ))}
          </div>
        )}
      </div>

      <!-- Hero Image -->
      {item.data.heroImage && (
        <div class="mb-12">
          <img 
            src={item.data.heroImage} 
            alt={item.data.title}
            class="w-full max-w-3xl mx-auto rounded-lg shadow-lg border-4 border-secondary-800"
          />
        </div>
      )}

      <!-- Press Content -->
      <article class="prose prose-invert prose-lg max-w-none mx-auto">
        <Content />
      </article>
      
    </div>
  </main>
  
  <Footer client:load />
</Layout>
