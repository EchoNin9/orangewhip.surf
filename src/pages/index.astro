---
import Layout from '../components/Layout.astro';
import { Header } from '../components/react/Header';
import { Hero } from '../components/react/Hero';
import { FeaturedContent } from '../components/react/FeaturedContent';
import { Footer } from '../components/react/Footer';
import { getCollection } from 'astro:content';

// Get upcoming gigs (limit to 3)
const allGigs = await getCollection('gigs');
const upcomingGigs = allGigs
  .filter(gig => gig.data.isUpcoming)
  .sort((a, b) => new Date(a.data.date).getTime() - new Date(b.data.date).getTime())
  .slice(0, 3);

// Get latest press (limit to 3)
const allPress = await getCollection('press');
const latestPress = allPress
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())
  .slice(0, 3);

// Get latest daily roundup
const allDaily = await getCollection('daily');
const latestDaily = allDaily
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())[0];
---

<Layout title="Orange Whip - Surf Rock Instrumentals from Vancouver">
  <Header client:load />
  <Hero client:load />
  <FeaturedContent 
    client:load
    upcomingGigs={upcomingGigs}
    latestPress={latestPress}
    latestDaily={latestDaily}
  />
  <Footer client:load />
</Layout>
